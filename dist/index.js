"use strict";var D=Object.create;var y=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var H=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var M=(n,e)=>{for(var t in e)y(n,t,{get:e[t],enumerable:!0})},b=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of j(e))!J.call(n,o)&&o!==t&&y(n,o,{get:()=>e[o],enumerable:!(r=R(e,o))||r.enumerable});return n};var F=(n,e,t)=>(t=n!=null?D(H(n)):{},b(e||!n||!n.__esModule?y(t,"default",{value:n,enumerable:!0}):t,n)),A=n=>b(y({},"__esModule",{value:!0}),n);var W={};M(W,{cacheProxy:()=>K});module.exports=A(W);var c=Symbol("NotFound"),U=1e3,Y=60*U,I=60*Y,l=24*I,z=7*l;var i=F(require("fs"),1),k=F(require("path"),1);var p=class{constructor(e={}){this.opts=e;this.cache={};this.cacheFile=e.path??"cache.json",this.autoSave=e.autoSave??!0;try{if(!i.existsSync(this.cacheFile))return;let t=i.readFileSync(this.cacheFile,"utf8");this.cache=JSON.parse(t)}catch{}}get(e,t){let r=this.cache[e];return r?Date.now()-r.timestamp>t?c:r.value:c}set(e,t){this.cache[e]={timestamp:Date.now(),value:t},this.autoSave&&this.save()}save(){i.mkdirSync(k.dirname(this.cacheFile),{recursive:!0}),i.writeFileSync(this.cacheFile,JSON.stringify(this.cache))}};function T(n,e,t,r,o,a=""){if(r[a])return r[a];let m=new Proxy(n,{get(f,d){let s=a+"/"+d.toString(),x=f[d];if(typeof x=="function"){if(o[s])return o[s];let E=x.bind(f),{defaultExpire:O=1*l,pathExpire:N={},onHit:P=()=>{},onMiss:C=()=>{}}=t,w=N[s]??O,S=function(...u){let h=s+": "+JSON.stringify(u),v=e.get(h,w);if(v!==c)return P(h,u),v;let g=E(...u);return e.set(h,g),C(h,u),g};return o[s]=S,S}return T(f[d],e,t,r,o,s)}});return r[a]=m,m}function K(n,e={}){let{cacheStore:t=new p}=e;return T(n,t,e,{},{})}0&&(module.exports={cacheProxy});
//# sourceMappingURL=index.js.map
